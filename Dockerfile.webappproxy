# Caddy proxy for Airbyte
FROM caddy:2.8.4-alpine
LABEL authors="Romaric P"

ARG AIRBYTE_WEBAPP_INTERNAL_HOST
ENV AIRBYTE_WEBAPP_INTERNAL_HOST=$AIRBYTE_WEBAPP_INTERNAL_HOST
ARG AIRBYTE_WEBAPP_INTERNAL_PORT
ENV AIRBYTE_WEBAPP_INTERNAL_PORT=$AIRBYTE_WEBAPP_INTERNAL_PORT

# Copy the Caddyfile
RUN cat <<EOF > /etc/caddy/Caddyfile
http:// {
    bind 0.0.0.0
    reverse_proxy /* http://$AIRBYTE_WEBAPP_INTERNAL_HOST:$AIRBYTE_WEBAPP_INTERNAL_PORT
}
EOF

